<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

    <form id="formulario" method="post" action="https://sandbox.gateway.payulatam.com/ppp-web-gateway">
      <input name="merchantId" type="hidden" value="508029">
      <input name="referenceCode" type="hidden" id="referenceCode"> <!-- setear por parametros -->
      <input name="description" type="hidden" value="La finalidad de esta prueba es demostrar como funciona el sistema de pagos a traves de la pasarela de PayU. realizado por Tie-in Solutions">
      <input name="amount" type="hidden" id="amount"> <!-- setear por parametros -->
      <input name="tax" type="hidden" value="0">
      <input name="taxReturnBase" type="hidden" value="0">
      <input name="signature" type="hidden" id="signature"> <!-- setear por javascript -->
      <input name="accountId" type="hidden" value="512321"> <!-- 652859 512321 -->
      <input name="currency" type="hidden" value="COP">
      <input name="buyerFullName" type="hidden" value="Usuario de prueba de tie in solutions">
      <input name="buyerEmail" type="hidden" value="info@tie-in.co">
      <input name="shippingAddress" type="hidden" value="calle 68b #50-91, Barranquilla, Atlantico, Colombia">
      <input name="shippingCity" type="hidden" value="Barranquilla">
      <input name="shippingCountry" type="hidden" value="Colombia">
      <input name="telephone" type="hidden" value="3002628599">
      <!-- <input name="Submit" type="submit" onmouseover="hash()" value="Enviar"> -->
    </form>

    <script src="javascripts/md5.min.js" type="text/javascript"></script>
    <script type="text/javascript">

      function getVarsUrl(){
         var url= location.search.replace("?", "");
         var arrUrl = url.split("&");
         var urlObj={};
         for(var i=0; i<arrUrl.length; i++){
             var x= arrUrl[i].split("=");
             urlObj[x[0]]=x[1]
         }
         return urlObj;
      }

      var param = getVarsUrl();
      // misVariablesGet.var1

      var referenceCode = param.ref;
      var amount = param.val;

      document.getElementById("referenceCode").value = referenceCode;
      document.getElementById("amount").value = amount;
      // alert(referenceCode+" "+amount);

      var hash = md5("4Vj8eK4rloUd272L48hsrarnUA~508029~"+referenceCode+"~"+amount+"~COP");
      document.getElementById("signature").value = hash;

      //-------------------->>>>>>>>>>>>>>>>>>>>>>>-------------------->>>>>>>>>>>>>>>>>>>>>>>-------------------->>>>>>>>>>>>>>>>>>>>>>>

      // function hash() {
      //
      //   var referenceCode = document.getElementById("referenceCode").value;
      //   var amount = document.getElementById("amount").value;
      //
      //   var hash = md5("4Vj8eK4rloUd272L48hsrarnUA~508029~"+referenceCode+"~"+amount+"~COP");
      //   // var hash = md5("4Vj8eK4rloUd272L48hsrarnUA~508029~"+referenceCode+"~"+amount+"~COP");
      //   document.getElementById("signature").value = hash;
      // }

      //-------------------->>>>>>>>>>>>>>>>>>>>>>>-------------------->>>>>>>>>>>>>>>>>>>>>>>-------------------->>>>>>>>>>>>>>>>>>>>>>>

      //alert(hash);

      //https://payu-tiein.herokuapp.com/?ref={referenceCode}&val={amount}
      document.getElementById("formulario").submit();
    </script>

  </body>
</html>
